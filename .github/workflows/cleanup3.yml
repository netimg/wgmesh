name: GHCR Cleanup 3 (Manual - Safe for Multi-Arch)

on:
  workflow_dispatch:  # Manual run button

jobs:
  cleanup:
    runs-on: ubuntu-latest
    permissions:
      packages: delete  # For deletion
      contents: read    # Often needed

    steps:
      - name: Cleanup old untagged versions (safe for multi-platform)
        uses: dataaxiom/ghcr-cleanup-action@v1
        with:
          token: ${{ secrets.GHCR_PAT }}  # Your PAT with delete:packages and read:packages
          # No other options needed â€“ default deletes safe untagged images
          dry-run: true  # Uncomment first to test (it logs what it'd delete, no action)
